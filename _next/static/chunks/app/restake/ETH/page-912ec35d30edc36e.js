(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2014],{95157:function(e,t,a){Promise.resolve().then(a.bind(a,9164))},9164:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return e8}});var n,r,s=a(81438),i=a(4766),o=a(75732),l=a(66427),d=a(92697),c=a(58911),u=a(42140),h=a(32725),f=a(75624),m=a(19020),p=a(2142),x=a(40589),v=a(38870),b=a(7534);let g=function(){let{onTxnSuccess:e,onTxnRevert:t,onTxnSettled:a,onSuccess:n,onError:r,onMutate:s,disableToast:i=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{data:o,isError:d,error:c}=(0,f.G)({address:x.stakeConfig.eigenPodManagerAddress,abi:p.Y1,functionName:"createPod"}),u=(0,v.U)(),g=eq(e=>e.updateTransaction),{data:T,isPaused:w,writeContract:C}=(0,b.Z)({disableToast:i,onMutate:()=>{null==s||s(),g({status:h.TransactionStatus.Pending})},onSuccess:e=>{null==n||n(e),g({hash:e})},onError:()=>{null==r||r(),g({status:h.TransactionStatus.Failed})},onTxnSuccess:t=>{null==e||e(t),g({status:h.TransactionStatus.Success,blockNumber:null==t?void 0:t.blockNumber})},onTxnRevert:t,onTxnSettled:a}),k=(0,l.useCallback)(()=>{(null==o?void 0:o.request)&&C(o.request)},[o,C]),y=(0,m.A)({hash:T,confirmations:2});return(0,l.useEffect)(()=>{(null==y?void 0:y.status)==="success"&&u.refetch()},[u,null==y?void 0:y.status]),{podCreationHandler:()=>{null==k||k()},createPod:k,isPodCreateError:d,createPodErrorMessage:c,podTransaction:y,isFetchingPodSummary:u.isFetching,isCreatePodLoading:w}};var T=a(27196),w=a(11442),C=a(92604),k=a(75347);let y=e=>{let{client:t,address:a,abi:n}=e;return(0,k.uN)({address:a,abi:n,client:t})};function j(e){let{client:t,address:a}=e;return y({address:a,abi:p.J_,client:t})}var E=a(77809);let N={provenCount:0,unprovenCount:0},S=function(){var e,t;let{podOwner:a,enabled:n,select:r=e=>null!=e?e:N,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{address:i}=(0,T.Z)(),o=(0,C.t)(),d=null!==(t=null===(e=a||i)||void 0===e?void 0:e.toLowerCase())&&void 0!==t?t:"",c=!1!==n||!!d,[h,f]=(0,l.useState)(),{data:{summary:m}}=(0,v.U)({podOwner:(0,u.fr)(d),enabled:c}),{data:p,...x}=E.h.native.podValidatorSummary.useQuery({podOwner:(0,u.fr)(d)},{enabled:c,select:r,...s});return(0,l.useEffect)(()=>{(async()=>{if(!o||!m.eigenPodAddress||!p)return f(p);try{let e=await j({client:o,address:m.eigenPodAddress}).read.activeValidatorCount();f({...p,provenCount:Math.max(p.provenCount,Number(null!=e?e:0n))})}catch(e){w.v.addError(e),f(p)}})()},[p,m.eigenPodAddress,o]),{data:h,...x}};var P=a(31680),_=a(45632),L=a(33376),O=a(44001),A=a(84465);let U=P.i9;function R(e){let{children:t,title:a}=e;return(0,s.jsxs)("div",{className:"flex flex-1 flex-col items-center gap-1.5 border-r border-r-blue-100",children:[(0,s.jsx)(i._T,{intent:"TextXS",font:"ibmPlexMono",className:"uppercase text-blue-400",children:a}),(0,s.jsx)("div",{className:"flex items-center gap-1.5",children:(0,s.jsx)(i._T,{intent:"TextL",className:"text-blue-800",children:t})})]})}function I(e){let{title:t,isOpen:a,setIsOpen:n,additionalTransactionCount:r=0,needsToStartCheckpoint:o=!0,description:d,onDone:c}=e,{data:h}=S(),f=(null==h?void 0:h.provenCount)||0,m=Math.ceil(f/U),p=Number(o)+r+m,x=(0,l.useMemo)(()=>{if(!p)return"--";let e=15*Number(o)+30+15*p;return e<60?"~".concat(e,"s"):"~".concat(Math.floor(e/30),"m")},[p,o]),v=(0,l.useMemo)(()=>{let e=95e3*m+58e3*f,[t,a]=["",1];e>=1e9?(t="B",a=1e9):e>=1e6?(t="M",a=1e6):e>=1e3&&(t="K",a=1e3);let n=e/a;return"".concat(n.toLocaleString(void 0,{maximumFractionDigits:n>=10?0:1})).concat(t)},[f,m]),b=(0,l.useCallback)(()=>{n(!1)},[n]);return(0,s.jsx)(A.fC,{open:a,children:(0,s.jsxs)(A.h_,{children:[(0,s.jsx)(A.aV,{onClick:b,className:"fixed top-0 z-[20] h-screen w-screen bg-black/40"}),(0,s.jsxs)(A.VY,{className:(0,u.cn)("fixed left-0 top-1/4 z-[25] mx-4 w-[calc(100%-32px)] transform rounded-lg bg-white outline-none","sm:left-1/2 sm:top-1/2 sm:mx-auto sm:w-[440px] sm:-translate-x-1/2 sm:-translate-y-1/2"),children:[(0,s.jsx)(A.$N,{className:"m-0 p-0",children:(0,s.jsx)(i._T,{intent:"TextXL",weight:"medium",className:"mx-4 mb-1 mt-4 block",children:t})}),(0,s.jsxs)(i._T,{intent:"TextS",weight:"medium",className:"mx-4 mb-4 block text-blue-400",children:[!!d&&(0,s.jsx)("p",{children:d}),(0,s.jsx)("span",{className:"mt-2 block text-blue-800",children:"You must finish this entire process once you start."})]}),(0,s.jsxs)("div",{className:"m-4 flex flex-row rounded-lg border border-blue-100 py-3",children:[(0,s.jsx)(R,{title:"Completion",children:x}),(0,s.jsx)(R,{title:"Gas",children:v}),(0,s.jsx)(R,{title:"Transactions",children:p}),(0,s.jsx)(R,{title:"Validators",children:f})]}),(0,s.jsx)("div",{className:"mb-4 px-4",children:(0,s.jsx)(i.xk,{className:"w-full uppercase",onClick:()=>{b(),null==c||c()},children:"Continue"})})]})]})})}var W=a(94188),F=a(38778);let M=Array(64),B=Array(123);for(let e=0;e<64;)B[M[e]=e<26?e+65:e<52?e+71:e<62?e-4:e-59|43]=e++;function q(e,t){return t&&t.constructor===Uint8Array?function(e,t,a){let n=null,r=[],s=0,i=0,o;for(;t<a;){let a=e[t++];switch(i){case 0:r[s++]=M[a>>2],o=(3&a)<<4,i=1;break;case 1:r[s++]=M[o|a>>4],o=(15&a)<<2,i=2;break;case 2:r[s++]=M[o|a>>6],r[s++]=M[63&a],i=0}s>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,r)),s=0)}return(i&&(r[s++]=M[o],r[s++]=61,1===i&&(r[s++]=61)),n)?(s&&n.push(String.fromCharCode.apply(String,r.slice(0,s))),n.join("")):String.fromCharCode.apply(String,r.slice(0,s))}(t,0,t.length):t}function D(e,t){let{pathPrefix:a,...n}=t||{};return fetch(a?"".concat(a).concat(e):e,n).then(e=>e.json().then(t=>{if(!e.ok)throw t;return t}))}(n=r||(r={})).OPERATION_STATUS_TRY_AGAIN="OPERATION_STATUS_TRY_AGAIN",n.OPERATION_STATUS_FAILURE="OPERATION_STATUS_FAILURE",n.OPERATION_STATUS_SUCCESS="OPERATION_STATUS_SUCCESS";class X{static GetCheckpointProofs(e,t){return D("/v1/checkpoint/proof",{...t,method:"POST",body:JSON.stringify(e,q)})}static GetWithdrawalCredentialsProofs(e,t){return D("/v1/withdrawal/proof",{...t,method:"POST",body:JSON.stringify(e,q)})}}var Z=a(43424);let V=function(){var e;let{eigenPodAddress:t,enabled:a,stub:n,select:r=e=>e,...s}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=(0,W.NL)(),o=(0,C.t)(),d=(0,l.useMemo)(()=>{var e;return["CheckpointProofs",t,null==o?void 0:null===(e=o.chain)||void 0===e?void 0:e.id]},[t,null==o?void 0:null===(e=o.chain)||void 0===e?void 0:e.id]),c=(0,F.a)({queryKey:d,queryFn:async()=>{if(!t||!o)return;let e=j({client:o,address:t});try{let[{proofsRemaining:a=0},n]=await Promise.all([e.read.currentCheckpoint(),K({eigenPodAddress:t})]);if(n)return{...n,balanceProofs:n.balanceProofs.slice(-a)}}catch(e){throw w.v.addError(e),e}},select:e=>{if(e)return r({...e,...n})},enabled:!1!==a&&!!t,...s}),u=(0,l.useCallback)(()=>{i.resetQueries({queryKey:d}),i.removeQueries({queryKey:d})},[d,i]);return{...c,clear:u}},K=async e=>{let{eigenPodAddress:t}=e,a=await X.GetCheckpointProofs({chainId:Z.O.NEXT_PUBLIC_CHAIN_ID,eigenpodAddress:t},{pathPrefix:Z.O.NEXT_PUBLIC_PROOFS_SERVICE_URL});if((null==a?void 0:a.status)!==r.OPERATION_STATUS_SUCCESS)throw Error("Failed to fetch checkpoint proofs");return function(e,t){var a,n;if(t&&e){if(!(null===(a=e.validatorBalancesRootProof)||void 0===a?void 0:a.validatorBalancesRoot)||!(null===(n=e.validatorBalancesRootProof)||void 0===n?void 0:n.proof)||!e.balanceProofs)throw Error("Invalid checkpoint proofs");return{eigenPodAddress:t,balanceContainerProof:{balanceContainerRoot:"0x".concat(e.validatorBalancesRootProof.validatorBalancesRoot),proof:"0x".concat(e.validatorBalancesRootProof.proof)},balanceProofs:e.balanceProofs.map(e=>{if(!e.pubKeyHash||!e.balanceRoot||!e.proof)throw Error("Invalid checkpoint proofs");return{pubkeyHash:"0x".concat(e.pubKeyHash),balanceRoot:"0x".concat(e.balanceRoot),proof:"0x".concat(e.proof)}})}}}(null==a?void 0:a.proofs,t)};var G=a(26821),H=a(3993);let Q=(0,c.Ue)(e=>({startCheckpointTransaction:P.vO,updateStartCheckpointTransaction:t=>e(e=>({startCheckpointTransaction:{...e.startCheckpointTransaction,...t}})),resetStartCheckpointTransaction:()=>e({startCheckpointTransaction:P.vO}),fetchCheckpointProofTxn:{status:h.TransactionStatus.NotStarted},updateFetchCheckpointProofTxn:t=>{let{status:a}=t;return e({fetchCheckpointProofTxn:{status:a}})},resetFetchCheckpointProofTxn:()=>e({fetchCheckpointProofTxn:{status:h.TransactionStatus.NotStarted}}),verifyCheckpointProofsTransaction:[P.vO],setEmptyCheckpointProofsTransactions:t=>e(()=>({verifyCheckpointProofsTransaction:[...Array(t)].fill(P.vO)})),updateVerifyCheckpointProofsTransaction:t=>a=>e(e=>({verifyCheckpointProofsTransaction:e.verifyCheckpointProofsTransaction.map((e,n)=>({...e,...n===t&&a}))})),resetVerifyCheckpointProofsTransaction:()=>e({verifyCheckpointProofsTransaction:[P.vO]}),resetFailedTransactions:()=>e(e=>({startCheckpointTransaction:(0,H.An)(e.startCheckpointTransaction),fetchCheckpointProofTxn:(0,H.An)(e.fetchCheckpointProofTxn),verifyCheckpointProofsTransaction:(0,H.An)(e.verifyCheckpointProofsTransaction)})),resetAll:()=>e({startCheckpointTransaction:P.vO,fetchCheckpointProofTxn:{status:h.TransactionStatus.NotStarted},verifyCheckpointProofsTransaction:[P.vO]})})),z=e=>{var t;let{eigenPodAddress:a,...n}=e,r=(0,l.useMemo)(()=>({address:a,abi:p.J_,functionName:"startCheckpoint",args:[!0],query:{enabled:!!a}}),[a]),s=(0,f.G)(r),o=null===(t=s.data)||void 0===t?void 0:t.request;(0,l.useEffect)(()=>{s.error&&a&&w.v.addError(s.error,{source:"useStartCheckpoint",simulation:!0,contract:r.address,functionName:r.functionName,args:r.args})},[s.error,a,r]);let d=Q(e=>e.updateStartCheckpointTransaction),{writeContract:c,...u}=(0,i.Hk)(G.v,{...n,updateTransaction:d,onTxnRevert(e){e&&w.v.addError(Error("Failed to start checkpoint"),{source:"useStartCheckpoint",hash:null==e?void 0:e.transactionHash,simulation:!1,receipt:e,contract:r.address,functionName:r.functionName,args:r.args})}}),h=(0,l.useCallback)(()=>o&&c(o),[o,c]);return(0,l.useEffect)(()=>{u.data&&w.v.addAction("transaction sent",{source:"useStartCheckpoint",hash:u.data})},[u.data]),{simulatedContract:s,writeContract:{...u,writeContract:c},startCheckpoint:h}},J=()=>Q(e=>{let t=e.verifyCheckpointProofsTransaction,{Pending:a,Failed:n,NotStarted:r}=h.TransactionStatus;for(let e=0;e<t.length;e++)if(e===t.length-1||[a,n,r].includes(t[e].status))return e;return 0}),Y=e=>{var t;let{checkpointProofs:a,estimatedNeededTxns:n,...r}=e,{eigenPodAddress:s,balanceContainerProof:o,balanceProofs:d}=null!=a?a:{},c=J(),u=Q(e=>e.setEmptyCheckpointProofsTransactions),h=(null==d?void 0:d.length)?Math.ceil(d.length/P.i9):null!=n?n:1;(0,l.useEffect)(()=>{h&&u(h)},[u,h]);let m=(0,l.useMemo)(()=>[...Array(h)].map((e,t)=>({address:s,abi:p.J_,functionName:"verifyCheckpointProofs",args:[o,null==d?void 0:d.slice(t*P.i9,(t+1)*P.i9)],query:{enabled:!!s&&!!a}})),[a,s,o,d,h])[c],x=(0,f.G)(m),v=null===(t=x.data)||void 0===t?void 0:t.request;(0,l.useEffect)(()=>{var e;x.error&&(null==m?void 0:null===(e=m.query)||void 0===e?void 0:e.enabled)&&w.v.addError(x.error,{source:"useVerifyCheckpointProofs",simulation:!0,contract:m.address,functionName:m.functionName,args:m.args})},[x.error,m]);let b=Q(e=>e.updateVerifyCheckpointProofsTransaction),{writeContract:g,...T}=(0,i.Hk)(G.v,{...r,updateTransaction:b(c),onTxnRevert(e){e&&w.v.addError(Error("Failed to verify checkpoint proofs"),{source:"useVerifyCheckpointProofs",hash:null==e?void 0:e.transactionHash,simulation:!1,receipt:e,contract:m.address,functionName:m.functionName,args:m.args})}});(0,l.useEffect)(()=>{T.data&&w.v.addAction("transaction sent",{source:"useVerifyCheckpointProofs",hash:T.data})},[T.data]);let C=(0,l.useCallback)(()=>v&&g(v),[v,g]);return{simulatedContract:x,...{...T,writeContract:g},verifyCheckpointProofs:C}},$=e=>{var t,a,n;let{eigenPodAddress:r,isActiveCheckpoint:s,onVerifySuccess:i,enabled:o}=e,{data:d}=S(),{data:{summary:c},refetch:u}=(0,v.U)(),{isFetching:f,isSuccess:m,isError:p,data:x,refetch:b,clear:g}=V({eigenPodAddress:null!==(a=c.eigenPodAddress)&&void 0!==a?a:void 0,enabled:!1}),T=(0,l.useCallback)(()=>{setTimeout(()=>{u(),g()},1500)},[u,g]),w=(0,l.useCallback)(()=>{T(),null==i||i()},[T,i]),{verifyCheckpointProofs:C,simulatedContract:k,writeContract:y}=Y({checkpointProofs:x,estimatedNeededTxns:Math.ceil((null!==(n=null==d?void 0:d.provenCount)&&void 0!==n?n:1)/P.i9),onTxnSuccess:w}),j=Q(e=>e.updateFetchCheckpointProofTxn),E=Q(e=>e.fetchCheckpointProofTxn),N=J(),_=Q(e=>e.verifyCheckpointProofsTransaction[N]);(0,l.useEffect)(()=>{f?j({status:h.TransactionStatus.Pending}):m?j({status:h.TransactionStatus.Success}):p&&j({status:h.TransactionStatus.Failed})},[f,m,p,j]),(0,l.useEffect)(()=>{var e;!1!==o&&(null===(e=k.data)||void 0===e?void 0:e.request)&&E.status===h.TransactionStatus.Success&&_.status===h.TransactionStatus.NotStarted&&y(k.data.request)},[o,null===(t=k.data)||void 0===t?void 0:t.request,E.status,_.status,y]);let{startCheckpoint:L}=z({eigenPodAddress:null!=r?r:void 0,onTxnSuccess:()=>{b()}});return{nativeUnstakedBalanceRestake:(0,l.useCallback)(()=>{if(!s)return L();b()},[s,L,b]),startCheckpoint:L,fetchCheckpointProof:b,verifyCheckpointProofs:C}},ee=e=>{var t;let{eigenPodAddress:a,query:n={}}=e,r=(0,W.NL)(),s=(0,O.u)({abi:p.J_,functionName:"currentCheckpointTimestamp",address:null!=a?a:void 0,query:{...n,enabled:!1!==n.enabled&&!!a}}),i=(0,l.useCallback)(()=>{r.resetQueries({queryKey:s.queryKey}),r.removeQueries({queryKey:s.queryKey})},[r,s.queryKey]);return{...s,clear:i,isActiveCheckpoint:(null!==(t=null==s?void 0:s.data)&&void 0!==t?t:0n)>0n}},et=()=>void 0,ea=e=>{let{transactionLabels:t={startCheckpoint:"Begin restaking process",fetchCheckpointProof:"Proving balance",verifyCheckpointProofs:"Restake"},setIsTransactionModalOpen:a,additionalTransactions:n=[],isTransactionModalOpen:r,enabled:s}=e,[i,o]=(0,l.useState)(null),{data:{summary:{eigenPodAddress:d}}}=(0,v.U)(),{isActiveCheckpoint:c}=ee({eigenPodAddress:d}),{nativeUnstakedBalanceRestake:u,startCheckpoint:f,fetchCheckpointProof:m,verifyCheckpointProofs:p}=$({eigenPodAddress:d,isActiveCheckpoint:c,enabled:s}),x=(0,l.useCallback)(()=>{a(!0),u()},[a,u]),b=Q(e=>e.startCheckpointTransaction),g=Q(e=>e.fetchCheckpointProofTxn),T=Q(e=>e.verifyCheckpointProofsTransaction),w=Q(e=>e.resetFailedTransactions),C=Q(e=>e.resetAll),k=J();(0,l.useEffect)(()=>{if(r)return;let{status:e,...a}=b;o(c&&e!==h.TransactionStatus.Success?null:{...a,label:t.startCheckpoint,write:f})},[r,t.startCheckpoint,f,b,c]);let y=(0,l.useMemo)(()=>i?{...i,status:b.status}:null,[i,b.status]);return{handleStartCheckpointProcess:x,resetFailedTransactions:w,modalTransactions:(0,l.useMemo)(()=>[y,{...g,label:t.fetchCheckpointProof,write:m},T.map((e,a)=>({...e,label:t.verifyCheckpointProofs,write:a===k?p:et})),...n].filter(Boolean),[y,k,g,m,T,p,n,t.fetchCheckpointProof,t.verifyCheckpointProofs]),resetAll:C}};var en=function(e){let{buttonLabel:t,isDisabled:a,refetch:n}=e,[r,o]=(0,l.useState)(!1),[d,c]=(0,l.useState)(!1),{data:{summary:{eigenPodAddress:u}}}=(0,v.U)(),{simulatedContract:h}=z({eigenPodAddress:null!=u?u:void 0}),{handleStartCheckpointProcess:f,resetFailedTransactions:m,modalTransactions:p}=ea({transactionLabels:{startCheckpoint:"Starting Checkpoint proofs",fetchCheckpointProof:"Generating Checkpoint proofs",verifyCheckpointProofs:"Verifying Checkpoint proofs"},isTransactionModalOpen:r||d,setIsTransactionModalOpen:c,enabled:(r||d)&&!h.isError}),{isActiveCheckpoint:x}=ee({eigenPodAddress:u});return(0,s.jsxs)(s.Fragment,{children:[!x&&(0,s.jsx)(i.xk,{size:i.dr.SM,intent:"secondary",className:"w-full",disabled:a,onClick:()=>o(!0),children:t}),(0,s.jsx)(I,{title:"Check Point Proofs Required Before Withdraw",isOpen:r,setIsOpen:o,needsToStartCheckpoint:!x,onDone:f,description:(0,s.jsx)(s.Fragment,{children:"Completing checkpoints proofs requires multiple transactions and can incur high gas costs. We recommend waiting for this balance to accumulate before restaking it."})}),(0,s.jsx)(i.Co,{transactions:p,resetFailedTransactions:m,isOpen:d,setIsOpen:c,showDone:!0,onDone:n,blockExplorerURL:Z.O.NEXT_PUBLIC_BLOCK_EXPLORER_URL,title:"Check Point Proofs"})]})},er=a(36069),es=a(63148),ei=a(79311);let eo=e=>{let{eigenPodAddress:t,query:a={}}=e,{data:n,refetch:r,...s}=(0,L.K)({address:null!=t?t:P.r_,query:{enabled:!!t!==a.enabled,refetchInterval:"number"==typeof a.refetchInterval?a.refetchInterval:12e3}}),{data:i,refetch:o,...d}=(0,O.u)({address:null!=t?t:P.r_,abi:p.J_,functionName:"withdrawableRestakedExecutionLayerGwei",query:{...a,enabled:!!t!==a.enabled}}),c=void 0!==(null==n?void 0:n.value)&&void 0!==i&&n.value/BigInt(1e9)!==i,u=(0,l.useCallback)(()=>{r(),o()},[r,o]);return{data:c,withdrawableRestakedExecutionLayerGwei:i,isLoading:s.isLoading||d.isLoading,isError:s.isError||d.isError,isFetching:s.isFetching||d.isFetching,isSuccess:s.isSuccess&&d.isSuccess,isLoadingError:s.isLoadingError||d.isLoadingError,isRefetching:s.isRefetching||d.isRefetching,isRefetchError:s.isRefetchError||d.isRefetchError,error:s.error||d.error,dataUpdatedAt:Math.max(s.dataUpdatedAt,d.dataUpdatedAt),errorUpdatedAt:Math.max(s.errorUpdatedAt,d.errorUpdatedAt),refetch:u}};var el=a(25568);let ed=()=>{let{data:e,...t}=S(),{uncompletedWithdrawals:a}=(0,el.z)(x.stakeConfig.nativeToken.strategyAddress),{data:n}=a,r=(0,l.useMemo)(()=>{let t=0n,a=0n;if(!(null==n?void 0:n.completableWithdrawals)||!(null==n?void 0:n.pendingWithdrawals)||!e)return{regularCompletableWithdrawals:[],regularCompletableWithdrawalAmount:t,regularPendingWithdrawals:[],regularPendingWithdrawalAmount:a,totalRegularWithdawalBalance:0n};let r=((null==n?void 0:n.completableWithdrawals)||[]).filter(a=>{if(a.isUndelegationQueue&&(null==e?void 0:e.provenCount))return!1;let n=a.strategies.findIndex(e=>(0,u.EU)(e,x.stakeConfig.nativeToken.strategyAddress));return t+=a.shares[n],!0}),s=((null==n?void 0:n.pendingWithdrawals)||[]).filter(t=>{if(t.isUndelegationQueue&&(null==e?void 0:e.provenCount))return!1;let n=t.strategies.findIndex(e=>(0,u.EU)(e,x.stakeConfig.nativeToken.strategyAddress));return a+=t.shares[n],!0}),i=t+a;return{regularCompletableWithdrawals:r,regularCompletableWithdrawalAmount:t,regularPendingWithdrawals:s,regularPendingWithdrawalAmount:a,totalRegularWithdawalBalance:i}},[e,null==n?void 0:n.completableWithdrawals,null==n?void 0:n.pendingWithdrawals]);return{...a,isLoading:a.isLoading||t.isLoading,isError:a.isError||t.isError,isFetching:a.isFetching||t.isFetching,isSuccess:a.isSuccess&&t.isSuccess,error:a.error||t.error,data:r}};var ec=a(62687),eu=a(34023),eh=a(72918);let ef="queueWithdrawalValue";function em(e){var t;let{tokenData:a,buttonContainerId:n,setIsOpen:r}=e,[o,d]=(0,l.useState)(),[c,f]=(0,l.useState)(!1),[m,b]=(0,l.useState)(!1),[g,T]=(0,l.useState)(!1),{data:{summary:{totalRestakedBalance:w,eigenPodAddress:C}},refetch:k}=(0,v.U)(),{uncompletedWithdrawals:{refetch:y}}=(0,el.z)(x.stakeConfig.nativeToken.strategyAddress),{data:{totalRegularWithdawalBalance:j}}=ed(),{isActiveCheckpoint:E}=ee({eigenPodAddress:C,query:{enabled:!!C&&!m&&!g}}),{data:N}=eo({eigenPodAddress:C}),{data:S,refetch:_}=(0,L.K)({address:null!=C?C:P.r_,query:{enabled:!!C}}),{data:A,refetch:U}=(0,O.u)({address:null!=C?C:P.r_,abi:p.J_,functionName:"withdrawableRestakedExecutionLayerGwei",query:{enabled:!!C,select:e=>e*BigInt(1e9)}});(0,l.useEffect)(()=>{g||d(N)},[N,m,g]),(0,l.useEffect)(()=>{w&&j&&(_(),U())},[_,U,w,j]);let R=(0,eh.ZP)(e=>e.updateTransaction),W=(0,eh.ZP)(e=>e.transaction),F=(0,eh.ZP)(e=>e.resetFailedTransactions),M=(0,eh.ZP)(e=>e.resetAll),B=S?S.value-(null!=A?A:0n):0n,q=H.Ie.max(H.Ie.min(w+B,((null==S?void 0:S.value)||0n)-j),0n),{amountAsShares:D,register:X,handleSubmit:V,isValid:K,onMaxHandler:G,watchedAmount:Q}=(0,ec.i)({token:a,maxWithdrawalAmount:q,interact:"withdraw",inputId:ef}),[z,J]=(0,l.useState)(!1),[Y,$]=(0,er.nj)(D,500),et=(0,l.useCallback)(()=>{setTimeout(()=>{k(),y()},2e3)},[k,y]),{simulatedQueueWithdrawal:en,writeContract:em}=(0,ei.m)({inputAmount:Y,token:a,onTxnSuccess:et,enabled:z}),ep=null===(t=en.data)||void 0===t?void 0:t.request,ex=(0,l.useCallback)(()=>{R({amount:Number(Q)||0}),J(!0)},[R,Q]),ev=(0,l.useMemo)(()=>[{status:W.status,hash:W.hash,blockNumber:W.blockNumber,label:"Queue withdrawal",subLabel:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Lm,{value:Number(Q),format:"balance"}),(0,s.jsx)("span",{className:"ml-1.5 inline-block",children:a.symbol})]}),write:ex}],[W,Q,ex,a.symbol]),{handleStartCheckpointProcess:eb,resetFailedTransactions:eg,modalTransactions:eT,resetAll:ew}=ea({isTransactionModalOpen:g,setIsTransactionModalOpen:T,transactionLabels:{startCheckpoint:"Begin withdrawal",fetchCheckpointProof:"Generating proofs",verifyCheckpointProofs:"Verifying balance"},additionalTransactions:ev,enabled:m||g}),eC=1===eT.length||eT.slice(0,-1).every((0,u.t1)("every",h.TransactionStatus.Success));(0,l.useEffect)(()=>{eC&&ex()},[eC,ex]),(0,l.useEffect)(()=>{g&&z&&ep&&W.amount&&em(ep)},[z,ep,g,W.amount,em]);let ek=(0,l.useCallback)(()=>{eg(),F()},[eg,F]);(0,l.useEffect)(()=>{c||(J(!1),ew(),M(),f(!0))},[c,M,ew]),(0,l.useEffect)(()=>{$(D)},[D,$]);let ey=Q&&(null==a?void 0:a.usd)?Number(Q)*a.usd:0,ej=(0,l.useCallback)(()=>{if(o)return b(!0);T(!0),ex()},[o,T,ex]),eE=document.getElementById(null!=n?n:eh.Bn);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(es.Z,{title:"Queue withdrawal",token:a,tokenData:a,register:X,isValid:K,onMaxHandler:G,usdValue:ey,onSubmit:V(ej),maxAmount:q,INPUT_ID:ef,FORM_ID:"queue-withdrawal-form",hideBalance:!0,buttonContainerElement:eE}),(0,s.jsx)(I,{title:"Queue withdrawal",isOpen:m,setIsOpen:b,needsToStartCheckpoint:!E,onDone:eb,additionalTransactionCount:ev.length,description:(0,s.jsx)(s.Fragment,{children:"Queuing this balance for withdrawal requires multiple transactions and can incur high gas costs. We recommend waiting for this balance to accumulate before withdrawing it."})}),(0,s.jsx)(i.Co,{isOpen:g,setIsOpen:T,transactions:o?eT:ev,title:"Queue withdrawal",resetFailedTransactions:ek,successModal:(0,s.jsx)(eu.Z,{tokenData:a,setIsOpen:e=>{T(e),null==r||r(e)},symbol:a.symbol,mode:"queueNativeWithdrawal"}),blockExplorerURL:Z.O.NEXT_PUBLIC_BLOCK_EXPLORER_URL})]})}var ep=a(97885),ex=a(30520),ev=a(81713),eb=a(25899);let eg="native-withdrawals-button-container";function eT(e){let{children:t,title:a,value:n,actions:r,hidden:o}=e,[d,c]=(0,l.useState)(t);return(0,l.useEffect)(()=>{if(t)return c(t);let e=setTimeout(c,350);return()=>clearTimeout(e)},[t]),(0,s.jsxs)("div",{"aria-hidden":o,className:(0,u.cn)("mt-4 max-h-full overflow-hidden rounded-md border border-blue-100 px-4 pb-5 opacity-100 transition-all duration-300",o&&"mt-0 max-h-0 pb-0 opacity-0"),children:[(0,s.jsxs)("div",{"aria-hidden":!n,className:(0,u.cn)("mt-5 flex max-h-full w-full flex-col items-center justify-between gap-5 opacity-100 transition-all duration-300 sm:flex-row",!n&&"mt-0 max-h-0 opacity-0"),children:[(0,s.jsxs)("div",{className:"flex w-full max-w-full shrink flex-col space-y-1 overflow-hidden",children:[(0,s.jsx)(i._T,{intent:"TextXS",className:"font-ibmPlexMono uppercase text-blue-400",children:a}),(0,s.jsxs)(i._T,{intent:"DisplayXS",weight:"medium",children:[(0,s.jsx)(i.Lm,{value:n,format:"balance"}),(0,s.jsx)("span",{className:"ml-1.5 inline-block text-blue-300",children:x.stakeConfig.nativeToken.symbol})]})]}),r&&(0,s.jsx)("div",{className:"flex shrink-0 items-center gap-2 max-sm:w-full",children:r})]}),(0,s.jsx)("div",{"aria-hidden":!t,className:(0,u.cn)("mt-5 max-h-[1000px] opacity-100 transition-all duration-300",!t&&"mt-0 max-h-0 opacity-0"),children:d})]})}function ew(e){let{tokenData:t,isVisibleWithoutPointedPods:a=!1}=e,{data:n}=(0,_.O)({query:{refetchInterval:6e4}}),[,r]=(0,ev.a)(x.stakeConfig.nativeToken.strategyAddress),{uncompletedWithdrawals:{refetch:o}}=(0,el.z)(x.stakeConfig.nativeToken.strategyAddress),{data:d}=S(),{data:{summary:{eigenPodAddress:c,totalRestakedBalance:h}},refetch:f}=(0,v.U)(),{data:m,refetch:b}=(0,L.K)({address:null!=c?c:void 0,query:{enabled:!!c}}),{data:{regularCompletableWithdrawals:g,regularPendingWithdrawals:T,regularCompletableWithdrawalAmount:w,totalRegularWithdawalBalance:C},refetch:k}=ed(),y=(0,l.useCallback)(()=>{f(),o(),k()},[f,o,k]),[j,E]=(0,l.useState)(!1),N=(0,l.useCallback)(()=>{E(!0)},[]),P=(0,l.useCallback)(()=>E(!1),[]),{data:A,refetch:U}=(0,O.u)({address:null!=c?c:void 0,abi:p.J_,functionName:"withdrawableRestakedExecutionLayerGwei",query:{enabled:!!c,select:e=>e*BigInt(1e9)}});(0,l.useEffect)(()=>{h&&C&&(b(),U())},[b,U,h,C]);let R=m?m.value-(null!=A?A:0n):0n,I=(0,l.useMemo)(()=>void 0!==(null==m?void 0:m.value)&&void 0!==A&&w>A&&m.value>=w,[m,A,w]),W=H.Ie.max(H.Ie.min(h+R,((null==m?void 0:m.value)||0n)-C),0n),[F,M]=(0,l.useState)(!1),B=(0,l.useCallback)(()=>{M(!1),setTimeout(y,2e3)},[y]),{completeWithdrawal:q,completeWithdrawalToedgelayerAI:D,withdrawalRootsCompleted:X}=(0,ex.PV)({withdrawals:g,onMutate:()=>M(!0),onTxnError:()=>M(!1),onError:()=>M(!1),onTxnSuccess:B});(0,l.useEffect)(()=>{X.length&&r(e=>[...e,...X.filter(t=>!e.includes(t))])},[X,r]),(0,l.useEffect)(()=>{if(T.length&&n&&T.reduce((e,t)=>t.completableBlock<e?BigInt(t.completableBlock):e,n+1n)<=n){let e=setTimeout(y,1e3);return()=>clearTimeout(e)}},[n,y,T]);let Z=!!(null==d?void 0:d.provenCount)||!!(null==d?void 0:d.unprovenCount),V=!!(null==g?void 0:g.length)||!!(null==T?void 0:T.length),K=!V&&!W,G=a?!K:Z&&!K;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{"aria-hidden":!G,className:(0,u.cn)("-mb-4 max-h-0 overflow-hidden opacity-0 transition-all duration-300",G&&"mb-0 max-h-full opacity-100"),children:(0,s.jsxs)("div",{className:"flex flex-col rounded-lg bg-white px-4 py-6",children:[(0,s.jsx)(i._T,{intent:"TextXL",weight:"medium",children:"Withdrawals"}),(0,s.jsx)(eT,{title:"Available to queue",value:W,hidden:!W,actions:(0,s.jsx)(i.xk,{size:i.dr.SM,intent:"secondary",className:"w-full",onClick:N,disabled:!W,children:"QUEUE WITHDRAWAL"})}),(0,s.jsx)(eT,{title:"Available to withdraw",value:null!=w?w:0n,hidden:!V,actions:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.xk,{size:i.dr.SM,intent:"secondary",className:"w-full",onClick:D,disabled:F||!g.length,children:"RESTAKE"}),I?(0,s.jsx)(en,{buttonLabel:"WITHDRAW",isDisabled:F||!g.length,refetch:()=>{B()}}):(0,s.jsx)(i.xk,{size:i.dr.SM,intent:"secondary",className:"w-full",onClick:q,disabled:F||!g.length,children:"WITHDRAW"})]}),children:!!(null==T?void 0:T.length)&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i._T,{intent:"TextM",className:"mb-2 block",children:"Withdrawal queue"}),(0,s.jsxs)("div",{className:"flex w-full items-center justify-between gap-4 border-t border-blue-50 py-3",children:[(0,s.jsx)(i._T,{intent:"TextXS",className:"font-ibmPlexMono uppercase text-blue-400",children:"Time remaining"}),(0,s.jsx)(i._T,{intent:"TextXS",className:"font-ibmPlexMono uppercase text-blue-400",children:"Amount"})]}),(0,s.jsx)("ul",{className:"w-full list-none",children:T.map((e,t)=>(0,s.jsxs)("li",{className:"flex w-full items-center justify-between gap-4 border-t border-blue-50 py-1.5",children:[(0,s.jsx)(i._T,{intent:"TextS",children:n?"~".concat((0,eb.H)(Number(n),e.completableBlock)):"--"}),(0,s.jsxs)(i._T,{intent:"TextS",children:[(0,s.jsx)(i.Lm,{value:e.shares[0],format:"balance"}),(0,s.jsx)("span",{className:"ml-1 inline-block text-blue-300",children:x.stakeConfig.nativeToken.symbol})]})]},t))})]})})]})}),(0,s.jsx)(ep.t,{steps:[{label:"Queue Withdrawal",isActive:!0,component:t?(0,s.jsx)(em,{tokenData:t,buttonContainerId:eg,setIsOpen:E}):(0,s.jsx)("div",{children:" Loading"})}],isOpen:j,setIsOpen:E,onBack:P,onCloseModal:P,buttonContainerId:eg})]})}let eC=(e,t)=>e.reduce((e,a)=>(a.strategies.forEach((n,r)=>{(0,u.EU)(n,t)&&(e+=a.shares[r])}),e),BigInt(0)),ek=()=>{let{data:e,...t}=S(),{uncompletedWithdrawals:a}=(0,el.z)(x.stakeConfig.nativeToken.strategyAddress),{data:n}=a,r=(0,l.useMemo)(()=>{var t,a;if(!(null==n?void 0:n.completableWithdrawals)||!(null==n?void 0:n.pendingWithdrawals)||!e)return{pendingUndelegationWithdrawals:[],pendingUndelegationBalance:0n,completableUndelegationWithdrawals:[],completableUndelegationBalance:0n,totalUndelegationBalance:0n};let r=null!==(t=null==n?void 0:n.pendingWithdrawals.filter(t=>t.isUndelegationQueue&&(null==e?void 0:e.provenCount)))&&void 0!==t?t:[],s=null!==(a=null==n?void 0:n.completableWithdrawals.filter(t=>t.isUndelegationQueue&&(null==e?void 0:e.provenCount)))&&void 0!==a?a:[],i=eC(r,x.stakeConfig.nativeToken.strategyAddress),o=eC(s,x.stakeConfig.nativeToken.strategyAddress);return{pendingUndelegationWithdrawals:r,completableUndelegationWithdrawals:s,pendingUndelegationBalance:i,completableUndelegationBalance:o,totalUndelegationBalance:i+o}},[n,e]);return{...a,isLoading:a.isLoading||t.isLoading,isError:a.isError||t.isError,isFetching:a.isFetching||t.isFetching,isSuccess:a.isSuccess&&t.isSuccess,error:a.error||t.error,data:r}};var ey=a(89832),ej=a(85728),eE=a(93134),eN=a(95011),eS=a(37238);function eP(e){let{isOpen:t,setIsOpen:a,buttonContainerId:n}=e,{data:r}=(0,eS.Z)(),i=(0,l.useCallback)(()=>{a(!1)},[a]);return r?(0,s.jsx)(ep.t,{steps:[{label:"Delegate",isActive:!0,component:(0,s.jsx)(eN.Z,{token:r,delegateOnly:!0,buttonContainerId:n,onDone:i})}],isOpen:t,setIsOpen:a,onBack:i,onCloseModal:i,buttonContainerId:n}):null}function e_(){let{isLoading:e,operatorSummary:t,isDelegated:a}=(0,eE.Z)(),{data:{completableUndelegationWithdrawals:n},refetch:r}=ek(),o=(0,eh.ZP)(e=>e.delegationTransaction),d=(0,ej.EX)(e=>e.resetUndelegateTransaction),c=(0,ej.EX)(e=>e.undelegateTransaction),u=(0,ej.EX)(e=>e.resetFailedTransaction),{data:{summary:{totalRestakedBalance:f}},isLoading:m,refetch:p}=(0,v.U)();(0,l.useEffect)(()=>{if(o.status===h.TransactionStatus.Success||c.status===h.TransactionStatus.Success){let e=setTimeout(()=>{r(),p()},2e3);return()=>clearTimeout(e)}},[o,c,p,r]),(0,l.useEffect)(()=>{o.status===h.TransactionStatus.Success&&c.status===h.TransactionStatus.Success&&d()},[c.status,o.status,d]);let x=(0,l.useCallback)(()=>{setTimeout(()=>{r(),p()},3e3)},[p,r]),{undelegate:b}=(0,ej.jt)({onTxnSuccess:x}),g=n.length>0,[T,w]=(0,l.useState)(!1),[C,k]=(0,l.useState)(!1),y=(0,l.useCallback)(()=>{w(!0),b()},[b]),j=c.status===h.TransactionStatus.Success&&f>=32*1e18||f<0?0n:f,E=(0,l.useMemo)(()=>[{...c,label:"Undelegate",subLabel:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(i.Lm,{value:j,format:"balance"})," ETH"]}),write:b}],[c,b,j]);return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:"rounded-lg border border-blue-100 px-4 py-5",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i._T,{intent:"TextXS",font:"ibmPlexMono",className:"mb-2 block text-blue-400",children:"RESTAKED BALANCE"}),m?(0,s.jsx)(i.yg,{intent:"DisplayXS"}):(0,s.jsxs)(i._T,{intent:"DisplayXS",weight:"medium",children:[(0,s.jsxs)("span",{className:"text-blue-700",children:[(0,s.jsx)(i.Lm,{value:j,format:"balance"})," "]}),(0,s.jsx)("span",{className:"text-blue-300",children:"ETH"})]})]}),a&&(0,s.jsx)(i.xk,{intent:"secondary",onClick:y,children:"UNDELEGATE"}),!a&&f>0&&!g&&(0,s.jsx)(i.xk,{intent:"secondary",onClick:()=>{k(!0)},children:"DELEGATE"})]}),(0,s.jsx)("hr",{className:"mb-3 mt-4 rounded-lg border border-blue-50"}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)(i._T,{intent:"TextXS",font:"ibmPlexMono",className:"text-blue-400",children:"DELEGATED TO"}),e?(0,s.jsx)(i.yg,{intent:"TextS"}):(0,s.jsx)(i._T,{intent:"TextS",weight:"medium",children:a?(0,s.jsx)(ey.D,{address:null==t?void 0:t.address,name:null==t?void 0:t.name,logo:null==t?void 0:t.logo}):(0,s.jsx)("span",{className:"text-blue-400",children:"Not delegated"})})]})]}),(0,s.jsx)(i.Co,{isOpen:T,setIsOpen:w,transactions:E,title:"Undelegate",description:"Undelegating allows you to change which operator you are delegated to. Undelegation takes 7 days to complete.",resetFailedTransactions:u,showDone:!0,blockExplorerURL:Z.O.NEXT_PUBLIC_BLOCK_EXPLORER_URL}),(0,s.jsx)(eP,{isOpen:C,setIsOpen:k,buttonContainerId:"restaked-balance-button-container"})]})}var eL=a(76957),eO=a(63921),eA=a(45268),eU=a(64087);let eR=(0,c.Ue)(e=>({completeWithdrawalTransaction:P.vO,updateCompleteWithdrawalTransaction:t=>e(e=>({completeWithdrawalTransaction:{...e.completeWithdrawalTransaction,...t}})),resetCompleteWithdrawalTransaction:()=>e(()=>({completeWithdrawalTransaction:P.vO})),completeWithdrawalToedgelayerAITransaction:P.vO,updateCompleteWithdrawalToedgelayerAITransaction:t=>e(e=>({completeWithdrawalToedgelayerAITransaction:{...e.completeWithdrawalToedgelayerAITransaction,...t}})),resetCompleteWithdrawalToedgelayerAITransaction:()=>e(()=>({completeWithdrawalToedgelayerAITransaction:P.vO})),resetFailedTransactions:()=>e(e=>({completeWithdrawalTransaction:(0,H.An)(e.completeWithdrawalTransaction),completeWithdrawalToedgelayerAITransaction:(0,H.An)(e.completeWithdrawalToedgelayerAITransaction)}))})),eI=e=>{var t,a;let{withdrawals:n,enabled:r,...s}=e,{address:o}=(0,T.Z)(),{refetch:d}=(0,eO.Z)(),{data:{strategyTokenMap:c}}=(0,eU.r)(),{refetch:u}=(0,v.U)(),{refetch:h}=(0,eA.$)({enabled:r}),m=(0,l.useCallback)(()=>{d(),h(),u()},[d,h,u]),p=(0,l.useMemo)(()=>c?(0,ex.tF)({withdrawals:n,receiveAsTokens:!0,strategyTokenMap:c}):void 0,[n,c]),x=(0,f.G)({...ex.mI,args:p,query:{enabled:!!o&&!!c}}),b=eR(e=>e.updateCompleteWithdrawalTransaction),g=(0,i.Hk)(G.v,{...s,onTxnSuccess:e=>{var t;m(),null===(t=s.onTxnSuccess)||void 0===t||t.call(s,e)},updateTransaction:b}),w=(0,l.useMemo)(()=>c?(0,ex.tF)({withdrawals:n,receiveAsTokens:!1,strategyTokenMap:c}):void 0,[n,c]),C=(0,f.G)({...ex.mI,args:w,query:{enabled:!!o&&!!c}}),k=eR(e=>e.updateCompleteWithdrawalToedgelayerAITransaction),y=(0,i.Hk)(G.v,{...s,onTxnSuccess:e=>{var t;m(),null===(t=s.onTxnSuccess)||void 0===t||t.call(s,e)},updateTransaction:k}),{writeContract:j}=y;return{completeWithdrawal:(0,l.useCallback)(()=>{var e,t;(null==x?void 0:null===(e=x.data)||void 0===e?void 0:e.request)&&(null==j||j(null==x?void 0:null===(t=x.data)||void 0===t?void 0:t.request))},[null==x?void 0:null===(t=x.data)||void 0===t?void 0:t.request,j]),completeWithdrawalSimulatedContract:x,completeWithdrawalWriteContract:g,completeWithdrawalToedgelayerAI:(0,l.useCallback)(()=>{var e;(null==C?void 0:null===(e=C.data)||void 0===e?void 0:e.request)&&(null==y||y.writeContract(C.data.request))},[null==C?void 0:null===(a=C.data)||void 0===a?void 0:a.request,y]),completeWithdrawalToedgelayerAISimulatedContract:C,completeWithdrawalToedgelayerAIWriteContract:y}};var eW=a(78130),eF=a(4725);function eM(){let e=(0,ej.EX)(e=>e.updateUndelegateTransaction),{refetch:t}=(0,v.U)(),{data:{pendingUndelegationBalance:a,completableUndelegationBalance:n,pendingUndelegationWithdrawals:r,completableUndelegationWithdrawals:o},refetch:d}=ek(),c=n>0n,f=r[0],m=null==f?void 0:f.completableBlock,{removeCompleteWithdrawalRoots:p}=(0,el.z)(x.stakeConfig.nativeToken.strategyAddress),{completeWithdrawalToedgelayerAI:b}=eI({withdrawals:o,onTxnSuccess:async t=>{t&&(p(await (0,H.Kl)(t)),e({status:h.TransactionStatus.NotStarted}))}}),g=eR(e=>e.completeWithdrawalToedgelayerAITransaction),T=eR(e=>e.resetFailedTransactions),[w,C]=(0,l.useState)(!1),k=(0,l.useMemo)(()=>[{label:"Complete Withdrawal",write:b,...g}],[b,g]),[y,j]=(0,l.useState)(!1),E=(0,l.useCallback)(()=>{j(!0),null==b||b()},[b]),[N,S]=(0,l.useState)(!1),{data:P,currentBlock:_}=(0,eF.F)({targetBlock:m,format:"compact",useBlockNumberParams:w?{query:{refetchInterval:6e3}}:void 0});(0,l.useEffect)(()=>{m&&_&&BigInt(m)-_<=6n&&C(!0)},[m,_]);let L=!!_&&_>=m,{isDelegated:O}=(0,eW.O4)();return(0,l.useEffect)(()=>{if(!L)return;let e=setTimeout(()=>{d(),C(!1)},2500);return()=>clearTimeout(e)},[L,d,t]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:(0,u.cn)("flex max-h-0 items-center justify-between rounded-lg border border-blue-100 opacity-0 transition-all",!(!(a>0n)&&!c)&&"mt-4 max-h-[2000px] px-4 py-5 opacity-100"),children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(i._T,{intent:"TextXS",font:"ibmPlexMono",className:"mb-2 block text-blue-400",children:"UNDELEGATED BALANCE"}),(0,s.jsxs)(i._T,{intent:"DisplayXS",weight:"medium",children:[(0,s.jsxs)("span",{className:"text-blue-700",children:[(0,s.jsx)(i.Lm,{value:(null!=n?n:0n)+(null!=a?a:0n),format:"balance"})," "]}),(0,s.jsx)("span",{className:"text-blue-300",children:"ETH"})]})]}),c?(0,s.jsx)(i.xk,{onClick:E,children:"Delegate"}):!L&&(0,s.jsxs)("a",{href:"".concat(Z.O.NEXT_PUBLIC_BLOCK_EXPLORER_URL,"/block/").concat(m),target:"_blank",rel:"noreferrer",className:"flex items-center gap-1.5 whitespace-nowrap rounded-lg bg-blue-50 px-2 py-1 hover:bg-blue-100",children:[(0,s.jsx)(eL.Z,{className:"h-4 w-4 text-blue-400"}),(0,s.jsx)(i._T,{intent:"TextXS",weight:"medium",className:"text-blue-400",children:P})]})]}),(0,s.jsx)(i.Co,{transactions:k,description:"In order to delegate, you first need to restake your withdrawn balance back to edgelayerAI.",isOpen:y,setIsOpen:j,title:"Complete Withdrawal",resetFailedTransactions:T,showDone:!0,doneLabel:"Delegate",onDone:()=>{O||S(!0),j(!1)},blockExplorerURL:Z.O.NEXT_PUBLIC_BLOCK_EXPLORER_URL}),(0,s.jsx)(eP,{isOpen:N,setIsOpen:S,buttonContainerId:"undelegated-balance-button-container"})]})}function eB(e){let{isVisibleWithoutPointedPods:t=!1}=e,{data:{summary:a}}=(0,v.U)(),{data:{totalUndelegationBalance:n}}=ek(),{data:r}=S(),o=a.totalRestakedBalance+n>0n,l=!!(null==r?void 0:r.provenCount)||!!(null==r?void 0:r.unprovenCount),d=t?o:l;return(0,s.jsx)("div",{"aria-hidden":!d,className:(0,u.cn)("-mb-4 max-h-0 overflow-hidden opacity-0 transition-all duration-300",d&&"mb-0 max-h-full opacity-100"),children:(0,s.jsxs)("div",{className:"rounded-lg bg-white px-4 py-6",children:[(0,s.jsx)(i._T,{intent:"TextXL",weight:"medium",className:"mb-4 block",children:"Your stake"}),(0,s.jsx)(e_,{}),(0,s.jsx)(eM,{})]})})}let eq=(0,c.Ue)(e=>({transaction:P.vO,updateTransaction:t=>e(e=>({transaction:{...e.transaction,...t}})),resetTransaction:()=>e({transaction:P.vO}),resetFailedTransaction:()=>e(e=>({transaction:{...e.transaction,status:e.transaction.status===h.TransactionStatus.Failed?h.TransactionStatus.NotStarted:e.transaction.status}}))}));function eD(e){let{tokenData:t}=e,[a,n]=(0,l.useState)(!1),r=eq(e=>e.transaction),o=eq(e=>e.resetFailedTransaction),{data:{summary:{eigenPodAddress:c}},refetch:h,isLoading:f}=(0,v.U)(),{data:m,refetch:p,isLoading:x}=S(),{isConnecting:b}=(0,T.Z)(),w=!!c,C=!!(null==m?void 0:m.provenCount)||!!(null==m?void 0:m.unprovenCount);(0,l.useEffect)(()=>{if(!w||C)return;let e=setInterval(p,6e4);return()=>clearInterval(e)},[p,C,w]);let{createPod:k}=g({disableToast:!0,onTxnSuccess:()=>{h()}}),y=()=>{n(!0),k()},j=b||x||f;return(0,s.jsxs)("div",{className:(0,u.cn)("absolute w-full overflow-hidden transition-all",C?"-z-[1] -mb-4 max-h-0 opacity-0":"z-5 mb-0 max-h-[5000px] opacity-100"),"aria-hidden":C,children:[(0,s.jsx)("div",{className:(0,u.cn)("mb-4 flex gap-3 rounded-lg bg-white px-4 py-6 opacity-100 transition-opacity",j&&"animate-pulse",C&&"opacity-0"),children:(0,s.jsxs)("div",{className:(0,u.cn)("grid grid-cols-[20px_1fr] gap-x-3 transition-opacity",j?"opacity-0":"opacity-100"),children:[(0,s.jsx)("div",{className:"col-start-1 col-end-2 row-start-1 row-end-2",children:w?(0,s.jsx)(d.Z,{className:"h-5 w-5 self-center text-blue-800"}):(0,s.jsx)("div",{className:"center text-blue-80 h-5 w-5 self-center rounded-full border border-blue-800",children:(0,s.jsx)(i._T,{intent:"TextS",children:"1"})})}),(0,s.jsx)(i._T,{weight:"medium",className:"col-start-2 col-end-3 row-start-1 row-end-2 block",children:"Create Eigenpod"}),(0,s.jsxs)(i._T,{intent:"TextS",weight:"medium",className:"col-start-2 col-end-3 row-start-2 row-end-3 mb-4 block text-blue-400",children:["In order to restake your beacon chain validators, you must first create an EigenPod. An"," ",(0,s.jsx)("a",{href:"https://github.com/Layr-Labs/edgelayerAI-contracts/blob/master/docs/core/EigenPodManager.md",target:"_blank",rel:"noreferrer",className:"underline",children:"EigenPod"})," ","is a smart contract managed by you, which allows the edgelayerAI protocol to monitor and manage balance and withdrawal statuses."]}),(0,s.jsx)("div",{className:"col-start-2 col-end-3 row-start-3 row-end-4 mb-10",children:w?(0,s.jsxs)("div",{className:"flex w-fit items-center gap-1.5 rounded-lg bg-emerald-700/10 px-2 py-1",children:[(0,s.jsx)(d.Z,{className:"h-5 w-5 text-emerald-600"}),(0,s.jsx)(i._T,{intent:"TextS",weight:"medium",className:"text-emerald-600",children:"EigenPod Created"})]}):(0,s.jsx)(i.xk,{onClick:y,children:(0,s.jsx)(i._T,{intent:"TextS",font:"ibmPlexMono",children:"Create Eigenpod"})})}),(0,s.jsx)("div",{className:(0,u.cn)("center col-start-1 col-end-2 row-start-4 row-end-5 h-5 w-5 shrink-0 self-center rounded-full border border-blue-800 text-blue-800",!w&&"opacity-30"),children:(0,s.jsx)(i._T,{intent:"TextS",children:"2"})}),(0,s.jsx)(i._T,{weight:"medium",className:(0,u.cn)("col-start-2 col-end-3 row-start-4 row-end-5 block",!w&&"opacity-30"),children:"Connect Validator to EigenPod"}),(0,s.jsxs)(i._T,{intent:"TextS",weight:"medium",className:(0,u.cn)("col-start-2 col-end-3 row-start-5 row-end-6 mb-4 block text-blue-400",!w&&"opacity-30"),children:["To give edgelayerAI access to your validators, use your staking client to point your validator to your EigenPod address. You may also choose to use your EigenPod as your validator's fee recipient. You will need to use the Command Line Interface for this step.",(0,s.jsx)("a",{href:P.NY,className:"text-blue-700 before:content-['_'] after:content-['_↗']",target:"_blank",rel:"noreferrer",children:"Learn more"})]}),w&&(0,s.jsx)("div",{className:(0,u.cn)("col-start-2 col-end-3 row-start-6 row-end-7",!w&&"opacity-30"),children:(0,s.jsxs)("div",{className:"flex w-fit items-center gap-1.5 rounded-lg bg-mustard-700/10 px-2 py-1",children:[(0,s.jsx)(i.TK,{className:"h-5 w-5 text-mustard-700",animate:!0}),(0,s.jsx)(i._T,{intent:"TextS",weight:"medium",className:"text-mustard-700",children:"Waiting for Connected Validators"})]})}),(0,s.jsx)("div",{className:"col-start-1 col-end-2 row-start-2 row-end-4 w-0.5 justify-self-center rounded-full bg-blue-700/20"})]})}),(0,s.jsx)(eB,{isVisibleWithoutPointedPods:!C}),(0,s.jsx)(ew,{tokenData:t,isVisibleWithoutPointedPods:!C}),(0,s.jsx)(i.Co,{transactions:[{status:r.status,blockNumber:r.blockNumber,hash:r.hash,label:"Create Eigenpod",subLabel:null,write:y}],title:"Create Eigenpod",resetFailedTransactions:o,isOpen:a,setIsOpen:n,showDone:!0,blockExplorerURL:Z.O.NEXT_PUBLIC_BLOCK_EXPLORER_URL})]})}let eX=Z.O.NEXT_PUBLIC_BLOCK_EXPLORER_URL;function eZ(){var e;let t=(0,i.pm)(),{data:a,isLoading:n}=(0,v.U)(),r=null!==(e=a.summary.eigenPodAddress)&&void 0!==e?e:void 0;return(0,s.jsxs)("div",{className:"flex flex-col rounded-lg bg-white-950 p-4",children:[(0,s.jsx)(i._T,{intent:"TextXL",weight:"medium",children:"EigenPod Address"}),(0,s.jsxs)("div",{className:(0,u.cn)("mt-4 flex flex-row items-center justify-between gap-4 rounded-lg bg-black-50 p-2 pl-4 pr-3",n&&"animate-pulse"),children:[(0,s.jsx)("div",{className:"truncate",children:(0,s.jsxs)(i._T,{intent:"TextS",className:(0,u.cn)("opacity-100 transition-opacity",!n&&!r&&"opacity-50",n&&"opacity-0"),children:[(0,u.Xn)(r),!n&&!r&&"EigenPod not created"]})}),(0,s.jsx)(i.hU,{size:i.dr.XS,intent:"secondary",disabled:!r,"aria-hidden":!r,"aria-label":"Copy Address",className:"scale-95 overflow-hidden transition-transform hover:scale-100 focus:scale-100 active:scale-110 disabled:scale-0",onClick:()=>{t.info((0,s.jsx)(i._T,{intent:"TextS",font:"ibmPlexMono",children:"Address copied!"}),{id:"copy"}),navigator.clipboard.writeText(r||"")},children:(0,s.jsx)(i.TI,{className:"text-blue-800"})})]}),(0,s.jsx)("div",{"aria-hidden":!r,className:(0,u.cn)("mt-4 max-h-20 w-full overflow-hidden opacity-100 transition-all",!r&&"mt-0 max-h-0 opacity-0"),children:(0,s.jsx)("a",{href:r&&"".concat(eX,"/address/").concat(r),target:"_blank",rel:"noreferrer",role:r?void 0:"link","aria-disabled":!r||void 0,children:(0,s.jsx)(i.xk,{intent:"secondary",size:i.dr.SM,className:"w-full","aria-label":"View on Etherscan",disabled:!r,children:"View on Etherscan ↗"})})})]})}function eV(){let{data:e}=S(),{data:{summary:{eigenPodAddress:t,unrestakedBalance:a}}}=(0,v.U)(),{clear:n}=V(),{data:{totalRegularWithdawalBalance:r}}=ed(),{data:{totalUndelegationBalance:o},isLoading:d}=ek(),[c,h]=(0,l.useState)(!1),[f,m]=(0,l.useState)(!1),{handleStartCheckpointProcess:p,resetFailedTransactions:b,modalTransactions:g}=ea({isTransactionModalOpen:c||f,setIsTransactionModalOpen:m,enabled:c||f}),{data:T}=eo({eigenPodAddress:t}),w=H.Ie.max(a-r-o,0),C=w>.001&&!!(null==e?void 0:e.provenCount)&&!!T,{isActiveCheckpoint:k}=ee({eigenPodAddress:t});return(0,l.useEffect)(()=>{f||n()},[f,n]),(0,s.jsxs)(s.Fragment,{children:[C?(0,s.jsxs)("div",{className:"rounded-lg bg-white px-4 py-6",children:[(0,s.jsx)(i._T,{intent:"TextXS",font:"ibmPlexMono",className:"bloc mb-2 text-blue-400",children:"UNSTAKED BALANCE"}),(0,s.jsxs)(i._T,{intent:"DisplayXS",weight:"medium",className:(0,u.cn)("mb-4 block",d&&"animate-pulse rounded-md bg-blue-200"),children:[(0,s.jsx)("span",{className:(0,u.cn)("text-blue-700",d&&"text-transparent"),children:(0,s.jsx)(i.Lm,{value:w,format:"balance",decimals:x.stakeConfig.nativeToken.decimals})})," ",(0,s.jsx)("span",{className:(0,u.cn)("text-blue-300",d&&"text-transparent"),children:"ETH"})]}),(0,s.jsx)(i.xk,{className:"w-full",onClick:()=>{h(!0)},children:(0,s.jsx)(i._T,{intent:"TextS",font:"ibmPlexMono",children:"Restake"})})]}):null,(0,s.jsx)(I,{title:"Restake",isOpen:c,setIsOpen:h,needsToStartCheckpoint:!k,onDone:p,description:(0,s.jsx)(s.Fragment,{children:"Restaking this balance requires multiple transactions and can incur high gas costs. We recommend waiting for this balance to accumulate before restaking it."})}),(0,s.jsx)(i.Co,{title:"Restake",transactions:g,resetFailedTransactions:b,isOpen:f,setIsOpen:m,showDone:!0,blockExplorerURL:Z.O.NEXT_PUBLIC_BLOCK_EXPLORER_URL})]})}var eK=a(86360),eG=a(42371);P.r_,P.r_,P.r_;let eH={eigenPodAddress:P.r_,beaconTimestamp:0n,stateRootProof:{beaconStateRoot:P.r_,proof:P.r_},withdrawalCredentialProofs:[]},eQ=function(){let{eigenPodAddress:e,enabled:t,stub:a,select:n=e=>e,...r}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},s=(0,W.NL)(),i=(0,F.a)({queryKey:["withdrawalCredentialProofs",e],queryFn:async()=>await eJ({eigenPodAddress:e}),select:e=>{if(e)return n({...e,...a})},enabled:!1!==t&&!!e,...r}),o=(0,l.useCallback)(()=>{let t=["withdrawalCredentialProofs",e];s.resetQueries({queryKey:t}),s.removeQueries({queryKey:t})},[e,s]);return{...i,clear:o}},ez=e=>"0x".concat(e),eJ=async e=>{let{eigenPodAddress:t}=e,a=await X.GetWithdrawalCredentialsProofs({chainId:Z.O.NEXT_PUBLIC_CHAIN_ID,eigenpodAddress:t},{pathPrefix:Z.O.NEXT_PUBLIC_PROOFS_SERVICE_URL});if((null==a?void 0:a.status)!==r.OPERATION_STATUS_SUCCESS||!(null==a?void 0:a.proofs))throw w.v.addError(Error("Failed to fetch withdrawal credential proofs")),Error("Failed to fetch withdrawal credential proofs");return function(e,t,a){if(!a||!e)return;let{stateRootProof:n,validatorIndices:r,validatorFieldProofs:s,validatorFields:i}=e;if(!t||!(null==r?void 0:r.length))return;let o=(null==r?void 0:r.length)||0;if(!(null==n?void 0:n.beaconStateRoot)||!(null==n?void 0:n.proof)||!(null==s?void 0:s.length)||!(null==i?void 0:i.length)||!(null==i?void 0:i.length)||s.length!==o||i.length!==o)throw Error("Failed to fetch withdrawal credential proofs");return{eigenPodAddress:a,beaconTimestamp:BigInt(t),stateRootProof:{beaconStateRoot:ez(n.beaconStateRoot),proof:ez(n.proof)},withdrawalCredentialProofs:Array.from({length:o}).map((e,t)=>({validatorIndex:Number(r[t]),validatorFieldsProof:ez(s[t]),validatorFields:(i[t].FieldsAsHex||[]).map(ez)}))}}(null==a?void 0:a.proofs,null==a?void 0:a.oracleBeaconTimestamp,t)},eY=(0,c.Ue)(e=>({fetchWithdrawalCredentialProofTxn:{status:h.TransactionStatus.NotStarted},updateFetchWithdrawalCredentialProofTxn:t=>e({fetchWithdrawalCredentialProofTxn:t}),resetFetchWithdrawalCredentialProofTxn:()=>e({fetchWithdrawalCredentialProofTxn:P.vO}),verifyWithdrawalCredentialProofsTxn:[P.vO],updateVerifyWithdrawalCredentialProofsTxn:t=>a=>e(e=>({verifyWithdrawalCredentialProofsTxn:e.verifyWithdrawalCredentialProofsTxn.map((e,n)=>({...e,...n===t&&a}))})),resetVerifyWithdrawalCredentialProofsTxn:()=>e({verifyWithdrawalCredentialProofsTxn:[P.vO]}),setEmptyWithdrawalCredentialProofsTxn:t=>e(()=>({verifyWithdrawalCredentialProofsTxn:[...Array(t)].fill(P.vO)})),resetFailedTransactions:()=>e(e=>({fetchWithdrawalCredentialProofTxn:(0,H.An)(e.fetchWithdrawalCredentialProofTxn),verifyWithdrawalCredentialProofsTxn:(0,H.An)(e.verifyWithdrawalCredentialProofsTxn)}))})),e$=()=>eY(e=>{let t=e.verifyWithdrawalCredentialProofsTxn,{Pending:a,Failed:n,NotStarted:r}=h.TransactionStatus;for(let e=0;e<t.length;e++)if(e===t.length-1||[a,n,r].includes(t[e].status))return e;return 0}),e0=e=>{var t;let{eigenPodAddress:a,withdrawalCredentialProofs:n,estimatedNeededTxns:r,...s}=e,{beaconTimestamp:o,stateRootProof:d,withdrawalCredentialProofs:c}=n||eH,u=e$(),h=(null==c?void 0:c.length)?Math.ceil(c.length/P.ER):null!=r?r:1,m=(0,l.useMemo)(()=>[...Array(h)].map((e,t)=>{let a=null==c?void 0:c.slice(t*P.ER,(t+1)*P.ER);return[o,d,a.map(e=>e.validatorIndex),a.map(e=>e.validatorFieldsProof),a.map(e=>e.validatorFields)]}),[h,o,d,c]),x=(0,l.useMemo)(()=>m.map(e=>({address:a,abi:p.J_,functionName:"verifyWithdrawalCredentials",args:e,query:{enabled:!!a&&!!e[0]}})),[a,m]),v=(0,f.G)(x[u]),b=null===(t=v.data)||void 0===t?void 0:t.request,g=eY(e=>e.updateVerifyWithdrawalCredentialProofsTxn),{writeContract:T,...w}=(0,i.Hk)(G.v,{...s,updateTransaction:g(u)}),C=(0,l.useCallback)(()=>b&&T(b),[b,T]);return{simulatedContract:v,writeContract:{...w,writeContract:T},verifyWithdrawalCredentials:C}},e1=()=>{var e,t;let{address:a}=(0,T.Z)(),{data:{summary:n},refetch:r,isLoading:s}=(0,v.U)(),{data:i,refetch:o,isLoading:d}=S(),{isFetching:c,isSuccess:u,isError:f,data:m,refetch:p,clear:x}=eQ({eigenPodAddress:n.eigenPodAddress||void 0,enabled:!1}),b=(0,l.useCallback)(()=>{setTimeout(()=>{o(),r()},1500)},[o,r]),g=eY(e=>e.updateFetchWithdrawalCredentialProofTxn),w=eY(e=>e.fetchWithdrawalCredentialProofTxn),{verifyWithdrawalCredentials:C}=e0({eigenPodAddress:n.eigenPodAddress||void 0,withdrawalCredentialProofs:m,estimatedNeededTxns:Math.ceil((null!==(e=null==i?void 0:i.unprovenCount)&&void 0!==e?e:1)/P.ER),onTxnSuccess:b}),k=e$(),y=eY(e=>e.verifyWithdrawalCredentialProofsTxn[k]);(0,l.useEffect)(()=>{c?g({status:h.TransactionStatus.Pending}):u&&m?g({status:h.TransactionStatus.Success}):f&&g({status:h.TransactionStatus.Failed})},[c,u,f,g,C,m]),(0,l.useEffect)(()=>{m&&w.status===h.TransactionStatus.Success&&y.status===h.TransactionStatus.NotStarted&&C()},[y.status,w.status,m,C]);let j=null!==(t=null==n?void 0:n.onBeaconChainUnproven)&&void 0!==t?t:0n,E=!!a&&!!(null==i?void 0:i.unprovenCount)&&j>0n;return(0,l.useEffect)(()=>{!a||s||d||E||x()},[d,a,s,E,x]),{weiAwaitingRestake:j,isActive:E,refetch:b,clearWithdrawalCredentialProofs:x,nativeUnverifiedValidatorsRestake:(0,l.useCallback)(()=>{p()},[p]),fetchWithdrawalCredentialProofs:p,verifyWithdrawalCredentials:C}},{nativeToken:e4}=x.stakeConfig,e2=()=>void 0,e3=(0,l.memo)(()=>{let{data:e}=S(),{weiAwaitingRestake:t,isActive:a,clearWithdrawalCredentialProofs:n,nativeUnverifiedValidatorsRestake:r,fetchWithdrawalCredentialProofs:o,verifyWithdrawalCredentials:d}=e1(),[c,h]=(0,l.useState)(!1),f=(0,eh.ZP)(e=>e.updateTransaction),[m,p]=(0,l.useState)(!1),x=(0,l.useCallback)(()=>{f({bigintAmount:t,amount:Number((0,eG.b)(t,e4.decimals))}),p(!0),r()},[r,t,f]),v=eY(e=>e.fetchWithdrawalCredentialProofTxn),b=eY(e=>e.verifyWithdrawalCredentialProofsTxn),g=eY(e=>e.resetFailedTransactions),T=e$(),w=(0,l.useMemo)(()=>{var t;return[{...v,label:"Proving validator balance".concat(null!==(t=null==e?void 0:e.provenCount)&&void 0!==t&&t?"s":""),write:o},b.map((e,t)=>({...e,label:"Restake",write:t===T?d:e2}))]},[null==e?void 0:e.provenCount,v,o,d,b,T]),{isDelegated:C}=(0,eW.O4)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{"aria-hidden":!a,className:(0,u.cn)("col-span-3 mb-0 max-h-80 w-full max-w-full origin-top overflow-hidden opacity-100 transition-all duration-300",!a&&"-mb-4 max-h-0 opacity-0"),children:[(0,s.jsxs)("div",{className:"flex max-w-full items-center justify-between gap-4 rounded-lg bg-white px-4 py-5 max-sm:flex-col",children:[(0,s.jsxs)("div",{className:"flex max-w-full shrink items-center gap-3 overflow-hidden",children:[(0,s.jsx)(eK.Z,{width:24,height:24,className:"h-8 w-8 shrink-0 text-blue-500"}),(0,s.jsxs)("div",{className:"flex max-w-full flex-col overflow-hidden",children:[(0,s.jsx)(i._T,{intent:"TextL",className:"max-w-full font-medium",children:"Validators awaiting restake"}),(0,s.jsx)(i._T,{intent:"TextS",className:"max-w-full overflow-hidden font-medium text-blue-300",children:"Validator balances can take up to 7 days to be reflected here depending on the current duration of the beacon chain deposit queue."})]})]}),(0,s.jsxs)("div",{className:"flex shrink-0 items-center gap-4 font-medium max-sm:w-full max-sm:justify-around",children:[(0,s.jsxs)("span",{className:"space-x-1",children:[(0,s.jsx)(i.Lm,{value:Number((0,eG.b)(t,e4.decimals)),format:"balance"}),(0,s.jsx)("span",{className:"text-blue-300",children:"ETH"})]}),(0,s.jsx)(i.xk,{size:i.dr.SM,disabled:!a,onClick:x,children:"RESTAKE"})]})]}),a&&(0,s.jsx)(i.Co,{title:"Restake",transactions:w,resetFailedTransactions:g,isOpen:m,setIsOpen:p,showDone:!0,doneLabel:C?"Done":"Delegate",onDone:()=>{C||h(!0),n()},buttonContent:(0,s.jsx)(i.xk,{onClick:()=>p(!1),intent:"secondary",className:"mt-2 w-full",children:"Skip"}),blockExplorerURL:Z.O.NEXT_PUBLIC_BLOCK_EXPLORER_URL})]}),(0,s.jsx)(eP,{isOpen:c,setIsOpen:h,buttonContainerId:"validator-awaiting-restake-button-container"})]})});e3.displayName="ValidatorAwaitingRestake";var e5=a(65355);function e6(e){let{token:t}=e,a="ETH"===t.symbol;return(0,s.jsxs)("div",{className:"flex flex-col gap-2 px-2 py-4 sm:px-4",children:[(0,s.jsxs)(i._T,{intent:"TextXL",weight:"medium",children:["About ",a?"Native Restaking":t.name]}),(0,s.jsx)(i._T,{intent:"TextS",className:"whitespace-pre-line text-blue-400",children:t.about})]})}var e7=a(57909),e8=function(){let{data:e}=(0,e7.Z)(),{data:t,isLoading:a}=(0,eS.Z)();return a?null:t?(0,s.jsxs)("div",{className:"grid w-full grid-cols-3 gap-4",children:[(0,s.jsx)(e5.Z,{token:t,showRestakeFlow:!1}),(0,s.jsx)(e3,{}),(0,s.jsx)("div",{className:"relative col-span-3 flex flex-col gap-4 rounded-lg md:col-span-2",children:e.isNativeMaintenanceMode?(0,s.jsx)(o.Z,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(eD,{tokenData:t}),(0,s.jsx)(eB,{}),(0,s.jsx)(ew,{tokenData:t})]})}),(0,s.jsx)("div",{className:"col-span-3 md:col-span-1",children:!e.isNativeMaintenanceMode&&(0,s.jsxs)("div",{className:"mr-auto flex flex-col gap-4 rounded-lg",children:[(0,s.jsx)(eV,{}),(0,s.jsx)(eZ,{}),(0,s.jsx)(e6,{token:t})]})})]}):(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)(i._T,{intent:"DisplayM",children:"Token not found"})})}},85728:function(e,t,a){"use strict";a.d(t,{EX:function(){return T},jt:function(){return w}});var n=a(81438),r=a(66427),s=a(75624),i=a(19020),o=a(58911),l=a(4766),d=a(2142),c=a(78130),u=a(7534),h=a(27196),f=a(63921),m=a(26821),p=a(40589),x=a(77809),v=a(31680),b=a(3993),g=a(92355);let T=(0,o.Ue)(e=>({undelegateTransaction:v.vO,updateUndelegateTransaction:t=>e(e=>({undelegateTransaction:{...e.undelegateTransaction,...t}})),resetUndelegateTransaction:()=>e({undelegateTransaction:v.vO}),resetFailedTransaction:()=>e(e=>({undelegateTransaction:(0,b.An)(e.undelegateTransaction)}))})),w=e=>{var t;let{address:a}=(0,h.Z)(),{refetch:n}=(0,f.Z)(),{data:i="",refetch:o}=(0,c.O4)(),{refetch:u}=(0,f.Z)(),{refetch:b}=x.h.operator.getOperatorSummary.useQuery({address:null==i?void 0:i.toLowerCase()},{enabled:!!i&&i!==v.r_}),{refetch:w}=(0,g.zd)({enabled:!!a}),C=(0,s.G)({address:p.stakeConfig.delegationManagerAddress,abi:d.oG,functionName:"undelegate",args:a&&[a],query:{enabled:!!i&&i!==v.r_&&!!a}}),k=null===(t=C.data)||void 0===t?void 0:t.request,y=T(e=>e.updateUndelegateTransaction),{writeContract:j,...E}=(0,l.Hk)(m.v,{...e,updateTransaction:y,onTxnSuccess(t){var a;null==e||null===(a=e.onTxnSuccess)||void 0===a||a.call(e,t),b(),n(),o(),u(),w()}}),N=(0,r.useCallback)(()=>k&&j(k),[k,j]);return{simulatedContract:C,writeContract:{...E,writeContract:j},undelegate:N}};t.ZP=e=>{var t;let{name:a}=e,{address:o}=(0,h.Z)(),{refetch:m}=(0,f.Z)(),{data:b="",refetch:T}=(0,c.O4)(),{refetch:w}=(0,f.Z)(),{refetch:C}=x.h.operator.getOperatorSummary.useQuery({address:null==b?void 0:b.toLowerCase()},{enabled:!!b&&b!==v.r_}),{refetch:k}=(0,g.zd)({enabled:!!o}),y=(0,s.G)({address:p.stakeConfig.delegationManagerAddress,abi:d.oG,functionName:"undelegate",args:o&&[o],query:{enabled:!!b&&b!==v.r_&&!!o}}),j=(0,n.jsx)(l.Lp,{address:b}),{writeContract:E,data:N,isPending:S,isSuccess:P,isError:_}=(0,u.Z)({successMsg:"Undelegated from ".concat(a||j),loadingMsg:"Undelegating from ".concat(a||j),errorMsg:"Undelegation submitted",onTxnSettled:()=>{m()},onTxnSuccess(){C(),m(),T(),w(),k()}}),L=(0,r.useCallback)(()=>{var e,t;(null===(e=y.data)||void 0===e?void 0:e.request)&&E(null===(t=y.data)||void 0===t?void 0:t.request)},[null===(t=y.data)||void 0===t?void 0:t.request,E]),{data:O,isLoading:A,isSuccess:U,isError:R}=(0,i.A)({hash:N});return{undelegate:L,undelegateData:N,isUndelegateLoading:S,isUndelegateSuccess:P,isUndelegateError:_,undelegateTxnData:O,isUndelegateTxnLoading:A,isUndelegateTxnSuccess:U,isUndelegateTxnError:R,isUndelegatePrepareError:y.isError,prepareContract:y}}}},function(e){e.O(0,[9971,9091,421,340,4428,6299,7382,4710,4227,2110,1442,9144,4648,4465,8208,1322,8474,5271,6784,4766,8140,5160,1027,6528,199,4168,2271,1744],function(){return e(e.s=95157)}),_N_E=e.O()}]);
//# sourceMappingURL=page-912ec35d30edc36e.js.map